build-app:
  stage: build
  image: docker:latest
  services:
    - docker:dind
  variables:
    DOCKER_DRIVER: overlay2
  before_script:
    - docker info
  script:
    - echo "üê≥ Building Docker Compose stack..."
    - COMPOSE_BAKE=true docker compose --env-file .env -f docker-compose.yml build 
    - docker image ls
    - docker save fintech512-project_ledgervest-web -o app.tar
  artifacts:
    paths:
      - app.tar
    expire_in: 1 hour
  only:
    - main
